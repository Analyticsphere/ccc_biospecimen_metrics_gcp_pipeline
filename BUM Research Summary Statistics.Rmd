---
title: "Blood, Urine, Mouthwash Survey Summary Statistics"
author: "Kelsey Dowling"
date: "`r Sys.Date()`"
header-includes:  
    \usepackage[labelformat=empty]{caption}
    \usepackage{placeins}
    \usepackage{booktabs}



output:
  pdf_document:
    extra_dependencies: ["float"]
    toc: true
    toc_depth: 2
    keep_tex: yes
    fig_width: 7
    fig_height: 5
    fig_caption: true
    df_print: paged
---


```{r libraries, include=FALSE}
library(bigrquery)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(scales)
library(gt)
#install(tinytex)
library(tinytex)
library(tidyr)
library(knitr)
library(kableExtra)
library(stringr)
library(lubridate)

options(tinytex.verbose = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

bq_auth()
```

```{r merge, include=FALSE}
project = "nih-nci-dceg-connect-prod-6d04"
billing= "nih-nci-dceg-connect-prod-6d04"
biospec <- "SELECT * FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.bioSurvey_v1`  where Connect_ID is not null"
parts <- "SELECT Connect_ID, token, D_512820379, D_471593703, state_d_934298480, D_230663853, d_827220437,
D_335767902, D_982402227, D_919254129, D_699625233, D_564964481, D_795827569, D_544150384,
D_371067537, D_430551721, D_821247024, D_914594314,  state_d_725929722, d_822499427, d_222161762,
D_949302066 , D_517311251, D_205553981, D_117249500, d_265193023, d_331584571_d_266600170_d_343048998, 
d_331584571_d_266600170_d_840048338, d_173836415_d_266600170_d_448660695
FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.participants` 
where Connect_ID IS NOT NULL and (d_512820379='486306141' OR d_512820379='854703046') and d_831041022='104430631' and d_821247024='197316935' and
d_331584571_d_266600170_d_840048338 is not null and d_331584571_d_266600170_d_343048998 is not null and d_265193023='231311385'"
specimenBUM <- "SELECT Connect_ID, d_556788178 FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.biospecimen` where Connect_ID is not null"


biospec_table <- bq_project_query(project, biospec, n_max = Inf, page_size = 1000)
parts_table <- bq_project_query(project, parts, n_max = Inf, page_size = 1000)

specimenBUM_table <- bq_project_query(project, specimenBUM)

biospec_data <- bq_table_download(biospec_table, bigint = "integer64")
parts_data <- bq_table_download(parts_table, bigint = "integer64")
specimenBUM_data <- bq_table_download(specimenBUM_table, bigint = "integer64",n_max = Inf, page_size = 1000)


parts_data$Connect_ID <- as.numeric(parts_data$Connect_ID) 
biospec_data$Connect_ID <- as.numeric(biospec_data$Connect_ID) 
specimenBUM_data$Connect_ID <- as.numeric(specimenBUM_data$Connect_ID) 


##Need to remove duplicates from the biospecimen table
rows_to_keep <- specimenBUM_data %>%
  group_by(Connect_ID) %>%
  filter(d_556788178 == min(d_556788178, na.rm = TRUE)) %>%
  ungroup()

bisp= left_join(parts_data, biospec_data, by="Connect_ID") %>%  left_join(rows_to_keep, by="Connect_ID") 
#dim(bisp)

BUM_tib <- as_tibble(bisp)
#dim(BUM_tib)

knitr::opts_chunk$set(comment = NA)

```


```{r counts, warning=FALSE, echo=FALSE}

cat("Particiapnts with Blood, Urine, Mouthwash Survey Completed: ", dim(bisp)[[1]])



```

```{r functions, include=FALSE}
##FUNCTIONS

dict <- list("104430631"="No", "353358909"="Yes", "178420302"="Unknown", "536341288"="Female", "576796184"="Unknown", "654207589"="Male",
                 "110092955"="The same day", "952212668"="The day before", "330461666"="More than a day before", "974230748"="Yes, in the past day",
                 "936042740"="Yes, in the past two days", "731141335"="Yes, in the past week", "591670915"="Yes, in the past month", "111520945"="Not at all",
                 "548628123"="A little bit", "567908725"="Somewhat", "760969884"="Quite a bit", "464631026"="Very Much", "707601969"="Yes, another",
                 "232063618"="Less than 1 month", "948148236"="Between 1 and 3 months", "692824372"="More than 3 months", "224099497"="Yes, mostly",
                 "770236544"="No, I never experienced this", "931688701"="Yes, I am experiencing this now", 
                 "586272115"="Yes, I experienced this in the past", "503154121"="Novavax" ,
                 "661871565"="Moderna", "657978450"="Pfizer", "411943417"="Johnson & Johnson", "113838601"="AstraZeneca", "807835037"="Other", 
                 "670680466"="Excellent", "927477599"="Very Good", "719933364"="Good", "131550264"="Fair", "138752522"="Poor", "648960871"="Never",
                 "693256778"="Less than Once Per Week", "735330419"="1-2 Times per Week", "138332277"="3-5 Times per Week", "858624942"="Once per Day", 
                 "85067541"="2-3 Times per Day", "317567178"="In the last month", "891558680"="In the last 1-6 months", "796081734"="In the past 6-12 months",
                 "752219885"="Over a year, in the Last Two Years", "314487612"="More than 2 years", "666365344"="Within the Last 24 Hours", 
                 "735136116"="In the Past 2-7 Days", "382679079"="In the last 2-4 weeks", "830677489"="More than 4 Weeks Ago", "349122068"="One",
                 "194129782"="Two to Four", "922737557"="Five to Nine", "945387130"="10+", "383505459"="More than 1 but Don't Remember", "832322940"="Don't Know",
                 "317811347"="Don't Know", "850675416"="Two or more times per day")

simple_funct_BUM <- function(CID, Title){  
  CID_SYM <- rlang::ensym(CID)

       gt_yn <- BUM_tib %>%
        filter(as.numeric(D_860011428)>=3) %>% 
    group_by(!!CID_SYM) %>%
    summarize(n = n(), percentage = 100 * n / nrow(.)) %>%
    ungroup() %>%
    mutate(answer = dplyr::recode(!!CID_SYM, !!!dict)) %>%
    replace_na(list(answer = "Skipped this Question")) %>%
    select(answer, n, percentage)
      
  gt_yn_kable <- gt_yn %>%
    mutate(
      percentage = round(percentage, 1),
      N = comma(n)
    ) %>%
    select(answer, N, percentage) %>%
    dplyr::rename(
      "Answer" = answer,
      "Pct" = percentage
    ) %>%
    bind_rows(
      tibble(
        Answer = "Total",
        N = comma(sum(gt_yn$n, na.rm = TRUE)),
        "Pct" = round(sum(gt_yn$Pct, na.rm = TRUE), 1)
      )
    )

  
  kable(gt_yn_kable, 
        caption = Title, align = "lrr",
        booktabs = TRUE, longtable = TRUE, escape = TRUE) %>%
    add_indent(seq(1, nrow(gt_yn_kable) - 1)) %>% 
    kable_styling(latex_options = c("scale_down"))
}

menstrual_funct <- function(CID, Title){  
  CID_SYM <- rlang::ensym(CID)
  
         gt_yn <- BUM_tib %>%
        filter(D_522008539==536341288) %>% 
    group_by(!!CID_SYM) %>%
    summarize(n = n(), percentage = 100 * n / nrow(.)) %>%
    ungroup() %>%
    mutate(answer = dplyr::recode(!!CID_SYM, !!!dict)) %>%
    replace_na(list(answer = "Skipped this Question")) %>%
    select(answer, n, percentage)
      
  gt_yn_kable <- gt_yn %>%
    mutate(
      percentage = round(percentage, 1),
      N = comma(n)
    ) %>%
    select(answer, N, percentage) %>%
    dplyr::rename(
      "Answer" = answer,
      "Pct" = percentage
    ) %>%
    bind_rows(
      tibble(
        Answer = "Total",
        N = comma(sum(gt_yn$n, na.rm = TRUE)),
        "Pct" = round(sum(gt_yn$Pct, na.rm = TRUE), 1)
      )
    )

  
  kable(gt_yn_kable, 
        caption = Title, align = "lrr",
        booktabs = TRUE, longtable = TRUE, escape = TRUE) %>%
    add_indent(seq(1, nrow(gt_yn_kable) - 1)) %>% 
    kable_styling(latex_options = c("scale_down"))
}


#One skip logic (previous response was one particular response)
one_skip_funct <- function(CID, Title, Previous_CID, Previous_Answer){  
  CID_SYM <- rlang::ensym(CID)
  CID_SYM_P <- rlang::ensym(Previous_CID)
  
     gt_yn <- BUM_tib %>%
        filter(!!CID_SYM_P==Previous_Answer) %>% 
    group_by(!!CID_SYM) %>%
    summarize(n = n(), percentage = 100 * n / nrow(.)) %>%
    ungroup() %>%
    mutate(answer = dplyr::recode(!!CID_SYM, !!!dict)) %>%
    replace_na(list(answer = "Skipped this Question")) %>%
    select(answer, n, percentage)
      
  gt_yn_kable <- gt_yn %>%
    mutate(
      percentage = round(percentage, 1),
      N = comma(n)
    ) %>%
    select(answer, N, percentage) %>%
    dplyr::rename(
      "Answer" = answer,
      "Pct" = percentage
    ) %>%
    bind_rows(
      tibble(
        Answer = "Total",
        N = comma(sum(gt_yn$n, na.rm = TRUE)),
        "Pct" = round(sum(gt_yn$Pct, na.rm = TRUE), 1)
      )
    )

  
  kable(gt_yn_kable, 
        caption = Title, align = "lrr",
        booktabs = TRUE, longtable = TRUE, escape = TRUE) %>%
    add_indent(seq(1, nrow(gt_yn_kable) - 1)) %>% 
    kable_styling(latex_options = c("scale_down"))
}


#Two skip logic (previous response has one of two responses)
two_skip_funct <- function(CID, Title, Previous_CID, Previous_Answer, Previous_CID2, Previous_Answer2){  
  CID_SYM <- rlang::ensym(CID)
  CID_SYM_P <- rlang::ensym(Previous_CID)
  CID_SYM_P2 <- rlang::ensym(Previous_CID2)
    
      gt_yn <- BUM_tib %>%
        filter(!!CID_SYM_P==Previous_Answer | !!CID_SYM_P2==Previous_Answer2) %>% 
    group_by(!!CID_SYM) %>%
    summarize(n = n(), percentage = 100 * n / nrow(.)) %>%
    ungroup() %>%
    mutate(answer = dplyr::recode(!!CID_SYM, !!!dict)) %>%
    replace_na(list(answer = "Skipped this Question")) %>%
    select(answer, n, percentage)
      
  gt_yn_kable <- gt_yn %>%
    mutate(
      percentage = round(percentage, 1),
      N = comma(n)
    ) %>%
    select(answer, N, percentage) %>%
    dplyr::rename(
      "Answer" = answer,
      "Pct" = percentage
    ) %>%
    bind_rows(
      tibble(
        Answer = "Total",
        N = comma(sum(gt_yn$n, na.rm = TRUE)),
        "Pct" = round(sum(gt_yn$Pct, na.rm = TRUE), 1)
      )
    )

  
  kable(gt_yn_kable, 
        caption = Title, align = "lrr",
        booktabs = TRUE, longtable = TRUE, escape = TRUE) %>%
    add_indent(seq(1, nrow(gt_yn_kable) - 1)) %>% 
    kable_styling(latex_options = c("scale_down"))

      
}



create_kable_table <- function(df, group_by_vriable, Title){  
  CID_SYM <- rlang::ensym(group_by_vriable)
  
  gt_yn <- df %>%
    group_by(!!CID_SYM) %>%
    summarize(n = n(), percentage = 100 * n / nrow(.)) %>%
    ungroup() %>%
    mutate(answer = dplyr::recode(!!CID_SYM, !!!dict)) %>%
    replace_na(list(answer = "Skipped this Question")) %>%
    select(answer, n, percentage)
  
  gt_yn_kable <- gt_yn %>%
    mutate(
      percentage = round(percentage, 1),
      N = comma(n)
    ) %>%
    select(answer, N, percentage) %>%
    dplyr::rename(
      "Answer" = answer,
      "Pct" = percentage
    ) %>%
    bind_rows(
      tibble(
        Answer = "Total",
        N = comma(sum(gt_yn$n, na.rm = TRUE)),
        "Pct" = round(sum(gt_yn$Pct, na.rm = TRUE), 1)
      )
    )

  
  kable(gt_yn_kable, 
        caption = Title, align = "lrr",
        booktabs = TRUE, longtable = TRUE, escape = TRUE) %>%
    add_indent(seq(1, nrow(gt_yn_kable) - 1)) %>% 
    kable_styling(latex_options = c("scale_down"))
}




create_kable_table_w_footnote <- function(df, group_by_vriable, Title){  
  CID_SYM <- rlang::ensym(group_by_vriable)
  
  gt_yn <- df %>%
    group_by(!!CID_SYM) %>%
    summarize(n = n(), percentage = 100 * n / nrow(.)) %>%
    ungroup() %>%
    mutate(answer = dplyr::recode(!!CID_SYM, !!!dict)) %>%
    replace_na(list(answer = "Skipped this Question")) %>%
    select(answer, n, percentage)
  
  gt_yn_kable <- gt_yn %>%
    mutate(
      percentage = round(percentage, 1),
      N = comma(n)
    ) %>%
    select(answer, N, percentage) %>%
    dplyr::rename(
      "Answer" = answer,
      "Pct" = percentage
    ) %>%
    bind_rows(
      tibble(
        Answer = "Total",
        N = comma(sum(gt_yn$n, na.rm = TRUE)),
        "Pct" = round(sum(gt_yn$Pct, na.rm = TRUE), 1)
      )
    )

  
  kable(gt_yn_kable, 
        caption = Title, align = "lrr",
        booktabs = TRUE, longtable = TRUE, escape = TRUE) %>%
    add_indent(seq(1, nrow(gt_yn_kable) - 1)) %>% 
    kable_styling(latex_options = c("scale_down")) %>% 
    footnote(general="Participants may select multiple responses or skip the question.", general_title = "")
}



#Histogram Function
hist_funct <- function(CID,Title, Xlab, Ylab) {
  CID_SYM <- rlang::ensym(CID)
  bisp %>% mutate(!!CID_SYM:=as.numeric(!!CID_SYM)) %>%
    filter(!is.na(!!CID_SYM)) %>% ggplot(aes(x=!!CID_SYM))+
     xlab(Xlab) + ylab(Ylab) + geom_histogram()+  ggtitle(Title)+
    geom_histogram(color="black")+ scale_y_continuous(breaks=pretty_breaks()) +
    geom_vline(aes(xintercept=mean(!!CID_SYM, na.rm=T)), colour="#2973A5", linetype="solid")
  
}

```






\newpage

```{r Tables1_3, warning=FALSE, echo=FALSE,  message=FALSE}



#SEX
simple_funct_BUM(D_522008539, "SEX: Biological Sex at Birth")



#SYMPTDAY
dt_SYMPTDAY_flags <- BUM_tib %>%
  mutate(
    Cough = as.numeric(D_470484596_D_756774083 == 1),
    Diarrhea = as.numeric(D_470484596_D_235386560 == 1),
    Nasal_Congestion = as.numeric(D_470484596_D_955154600 == 1),
    Sick_to_Your_Stomach_or_Vomitting = as.numeric(D_470484596_D_811126581 == 1),
    Fever = as.numeric(D_470484596_D_406943303 == 1),
    None_of_these = as.numeric(D_470484596_D_535003378 == 1),
    Skipped = if_else(
      rowSums(select(., starts_with("D_470484596_D_")) == 0, na.rm = FALSE) == ncol(select(., starts_with("D_470484596_D_"))), 1, 0))

dt_SYMPTDAY_long <- dt_SYMPTDAY_flags %>%
  pivot_longer(
    cols = c(
      Cough,
      Diarrhea,
      Nasal_Congestion,
      Sick_to_Your_Stomach_or_Vomitting,
      Fever,
      None_of_these,
      Skipped
    ),
    names_to = "symptom_flag",
    values_to = "Flag"
  ) %>%
  filter(Flag == 1) %>%
  mutate(
    symptom = case_when(
      symptom_flag == "Cough" ~ "Cough",
      symptom_flag == "Diarrhea" ~ "Diarrhea",
      symptom_flag == "Nasal_Congestion" ~ "Nasal Congestion",
      symptom_flag == "Sick_to_Your_Stomach_or_Vomitting" ~ "Sick to Your Stomach or Vomitting",
      symptom_flag == "Fever" ~ "Fever",
      symptom_flag == "None_of_these" ~ "None of these",
      symptom_flag == "Skipped" ~ "Skipped this Question"
    )
  )


create_kable_table_w_footnote(dt_SYMPTDAY_long, symptom_flag, "Table 2: Symptoms in the 24 hours Prior to Sample Donation")



#EATDRINKBEFORE
simple_funct_BUM(D_867307558, "Table 3: When Last Food or Beverage Consumed")


```



```{r Table4, echo=FALSE, warning=FALSE, message=FALSE}


avg_coll <- BUM_tib %>%  filter((d_827220437==531629870 |  d_827220437==548392715 | d_827220437==303349821 | 
                                d_827220437==657167265 | d_827220437==809703864) & 
                               !is.na(D_867307558)) %>%  
  mutate(D_191057574V=coalesce(D_191057574, D_191057574_V2),
         MW_date = as.Date(d_173836415_d_266600170_d_448660695),
         MW_dayb4 = MW_date - days(1),
         eat= case_when(D_867307558==110092955 ~ paste0(str_sub(d_173836415_d_266600170_d_448660695,1,11), D_191057574V, ":00.000Z"),
                                                  D_867307558==952212668 ~ paste0(MW_dayb4, D_191057574V, ":00.000Z" )),
         time = as.numeric(difftime(as.POSIXct(ymd_hms(d_173836415_d_266600170_d_448660695)),as.POSIXct(ymd_hms(eat)),units="hours")),
         MW = case_when( as.numeric(abs(abs(time))) >72 ~">72hrs",
                         72 >= as.numeric(abs(time)) & as.numeric(abs(time)) > 48 ~ "> 48 hrs to 72 hrs",
                         48 >= as.numeric(abs(time)) & as.numeric(abs(time)) > 24 ~ "> 24 hrs to 48 hrs",   
                         24 >= as.numeric(abs(time)) & as.numeric(abs(time)) > 12 ~ "> 12 hrs to 24 hrs",
                         12 >= as.numeric(abs(time)) & as.numeric(abs(time)) > 3 ~ "> 3 hrs to 12 hrs",  
                         3 >= as.numeric(abs(time)) & as.numeric(abs(time)) >= 0 ~ "0 hrs to 3 hrs",
                         TRUE ~ "Missing Time"),
         MW = factor(MW, levels= c(  "Missing Time", "0 hrs to 3 hrs", "> 3 hrs to 12 hrs", "> 12 hrs to 24 hrs", 
                                     "> 24 hrs to 48 hrs", "> 48 hrs to 72 hrs", ">72hrs")),
         Site=case_when(d_827220437==531629870 ~ "HealthPartners",
                        d_827220437==548392715 ~ "Henry Ford Health System",
                        d_827220437==303349821 ~ "Marshfield Clinical Health System",
                        d_827220437==657167265 ~ "Sanford Health",
                        d_827220437==809703864 ~ "University of Chicago Medicine",
                        d_827220437==125001209 ~ "Kaiser Permanente Colorado",
                        d_827220437==327912200 ~ "Kaiser Permanente Georgia",
                        d_827220437==300267574 ~ "Kaiser Permanente Hawaii",
                        d_827220437==452412599 ~ "Kaiser Permanente Northwest"))


MW_time1 <- avg_coll %>% group_by(Site, MW) %>%  summarize(n=n(), percentage=100*n/nrow(.)) %>%  select(Site,  MW, n, percentage) 
  
MW_time1 %>%  gt::gt()  %>%  
  fmt_number(columns = "percentage", decimals = 1) %>% 
  tab_header(title = md("Table 4. Time from Last Meal to Time of Mouthwash Collection")) %>% 
  cols_label(n= md("**N**"), MW = md("**Answer**"), percentage = md("**Pct**")) %>%  
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))


```




\FloatBarrier


```{r RemovedGraphs, warning=FALSE, echo=FALSE,  message=FALSE}



#EATDRINKTIME
EATDRINKTIME_V1=bisp %>% filter(!is.na(D_191057574) & (D_867307558== "952212668"| D_867307558=="330461666")) %>% ggplot(aes(x=D_191057574))+ ylab("Count") + 
  xlab("Time (Military Time)") +geom_bar()+  ggtitle("EATDRINKTIME(V1): Time Food or Beverage Last Consumed") +theme(axis.text.x = element_text(angle = 90))

EATDRINKTIME_V2=bisp %>% filter(!is.na(D_191057574_V2) & (D_867307558== "952212668"| D_867307558=="330461666")) %>% ggplot(aes(x=D_191057574_V2))+ ylab("Count") + 
  xlab("Time (Military Time)") +geom_bar()+  ggtitle("EATDRINKTIME(V2): Time Food or Beverage Last Consumed") +theme(axis.text.x = element_text(angle = 90))
#grid.arrange(EATDRINKTIME_V1, EATDRINKTIME_V2, nrow=2)


#SLEEPTIME
SLEEPTIME_V1=bisp %>% filter(!is.na(D_299417266)) %>% ggplot(aes(x=D_299417266))+ ylab("Count") + 
  xlab("Time (Military Time)") +geom_bar()+  ggtitle("SLEEPTIME(V1): Bedtime the Night Before Donation") +theme(axis.text.x = element_text(angle = 90))

SLEEPTIME_V2=bisp %>% filter(!is.na(D_299417266_V2)) %>% ggplot(aes(x=D_299417266_V2))+ ylab("Count") + 
  xlab("Time (Military Time)") +geom_bar()+  ggtitle("SLEEPTIME(V2): Bedtime the Night Before Donation") +theme(axis.text.x = element_text(angle = 90))
#grid.arrange(SLEEPTIME_V1, SLEEPTIME_V2, nrow=2)



BUM_sig <- BUM_tib %>%  filter(!is.na(D_299417266_V2) | !is.na(D_299417266)) %>%  #v1 and v2 were answered in this survey
  mutate(sleep = paste0(str_sub(d_556788178,1,11), 
                        ifelse(!is.na(D_299417266_V2),  str_sub(D_299417266_V2,1,5),  str_sub(D_299417266,1,5)), #choose whichever was answered
                        str_sub(d_556788178,17,24)),
         slptime= paste0(as.Date(sleep) -1, "T", str_sub(sleep,12,24)), #question is time you went to bed the night BEFORE, so have to subtract a day 
         time_sleep = difftime(as.POSIXct(ymd_hms(d_556788178)), as.POSIXct(ymd_hms(slptime)),units="hours"),
         time=as.numeric(time_sleep)) 


BUM_SLEEP = BUM_sig %>% #group_by(Site) %>% #biochk_outlier,
  dplyr::summarize('Number of Participants'=n(),
                   Min = min(time,na.rm = TRUE),
                   Q1 = quantile(time, 0.25,na.rm = TRUE),
                   Median = median(time,na.rm = TRUE),
                   Mean = mean(time,na.rm = TRUE),
                   SD=sd(time,na.rm = TRUE),
                   Q3 = quantile(time, 0.75,na.rm = TRUE),
                   Max = max(time,na.rm = TRUE))
bm_wake <- knitr::kable(BUM_SLEEP,caption='Table 5: Hours Participant Fell Asleep Before Sample Donation',digits=1, booktabs = TRUE)%>% kable_styling(latex_options = "scale_down") #%>% landscape()
add_footnote(bm_wake,"Note: Those who did not answer this question are removed from the Number of Participants in order to calculate difference in existing times.", notation = "none") #and greater than 500 minutes 




#WAKETIME
WAKETIME_V1=bisp %>% filter(!is.na(D_689861450)) %>% ggplot(aes(x=D_689861450))+ ylab("Count") + 
  xlab("Time (Military Time)") +geom_bar()+  ggtitle("WAKETIME(V1): Wake-up Time the Day of Donation") +theme(axis.text.x = element_text(angle = 90))

WAKETIME_V2=bisp %>% filter(!is.na(D_689861450_V2)) %>% ggplot(aes(x=D_689861450_V2))+ ylab("Count") + 
  xlab("Time (Military Time)") +geom_bar()+  ggtitle("WAKETIME(V2): Wake-up Time the Day of Donation") +theme(axis.text.x = element_text(angle = 90))
#grid.arrange(WAKETIME_V1, WAKETIME_V2, nrow=2)




BUM_sig <- BUM_tib %>%  filter(!is.na(D_689861450_V2) | !is.na(D_689861450)) %>%  #v1 and v2 were answered in this survey
  mutate(wake2 = paste0(str_sub(d_556788178,1,11), 
                        ifelse(!is.na(D_689861450_V2),  str_sub(D_689861450_V2,1,5),  str_sub(D_689861450,1,5)), #whichever one was answered
                        str_sub(d_556788178,17,24)),
         time_biochk2 = difftime(as.POSIXct(ymd_hms(d_556788178)), as.POSIXct(ymd_hms(wake2)),units="hours"),
         time2=as.numeric(time_biochk2)) 


BUM_WAKE = BUM_sig %>% #group_by(Site) %>% #biochk_outlier,
  dplyr::summarize('Number of Participants'=n(),
                   Min = min(time2,na.rm = TRUE),
                   Q1 = quantile(time2, 0.25,na.rm = TRUE),
                   Median = median(time2,na.rm = TRUE),
                   Mean = mean(time2,na.rm = TRUE),
                   SD=sd(time2,na.rm = TRUE),
                   Q3 = quantile(time2, 0.75,na.rm = TRUE),
                   Max = max(time2,na.rm = TRUE))
bm_wake <- knitr::kable(BUM_WAKE,caption='Table 6: Hours Awakened Before Sample Donation',digits=1, booktabs = TRUE)%>% kable_styling(latex_options = "scale_down") #%>% landscape()
add_footnote(bm_wake,"Note: Those who did not answer this question are removed from the Number of Participants in order to calculate difference in existing times.", notation = "none") #and greater than 500 minutes 



```

\newpage

# Medications
```{r Meds, warning=FALSE, echo=FALSE,  message=FALSE}

BUM_tib$D_487532606_D_619765650 <- factor(BUM_tib$D_487532606_D_619765650,levels=c(104430631, 974230748, 936042740, 731141335, 591670915, "Skipped this Question"))
BUM_tib$D_487532606_D_520755310 <- factor(BUM_tib$D_487532606_D_520755310,levels=c(104430631, 974230748, 936042740, 731141335, 591670915, "Skipped this Question"))
BUM_tib$D_487532606_D_839329467 <- factor(BUM_tib$D_487532606_D_839329467,levels=c(104430631, 974230748, 936042740, 731141335, 591670915, "Skipped this Question"))

simple_funct_BUM(D_487532606_D_619765650, "TYLENOL: Medication Taken, if so, Last Time Taken")

simple_funct_BUM(D_487532606_D_520755310, "NSAIDS: Medication Taken, if so, Last Time Taken")

simple_funct_BUM(D_487532606_D_839329467, "Acid Reducers: Medication Taken, if so, Last Time Taken")



```

\newpage
\pagebreak

# Reproductive Health 
```{r ReproductiveHealth, warning=FALSE, echo=FALSE,  message=FALSE}


#MENSTPRD
menstrual_funct(D_380603392, "MENSTPRD: Had Menstrual Period in the Last 12 Months")


#MENST60
one_skip_funct(D_112151599, "MENST60: Had Menstrual Period in the Last 60 Days", D_380603392, "353358909") 



#MENSTART
BUM_tibM <- BUM_tib %>%  filter(!is.na(D_644459734) & D_112151599=="353358909")
BUM_tibM$Mdate <- as.Date(BUM_tibM$D_644459734)

BUM_TimeM <- BUM_tibM  %>% dplyr::group_by(Mdate) %>% dplyr::summarize(n=n()) %>% dplyr::ungroup() %>%  dplyr::select(Mdate, n)

pM <- ggplot(BUM_TimeM, aes(x=Mdate, y=n)) +
       geom_line() +xlab("Date") + ylab("Participants") +  ggtitle("Plot 1: Most Recent Menstrual Period Start Date")
pM + scale_x_date(date_labels = "%b %Y")


#PREGNANT
menstrual_funct(D_518916981, "PREGNANT: Currently Pregnant")


#PREG3MON
one_skip_funct(D_234714655, "Table 13: Been Pregnant in the Last 3 Months", D_518916981, "104430631") 

#BRSTFD
menstrual_funct(D_798452445, "Table 14: Currently Breastfeeding")

#BRSTFD3MON
one_skip_funct(D_563539159, "Table 15: Breastfed in the Last 3 Months", D_798452445, "104430631") 

#CONTRACEPT
one_skip_funct(D_875535246, "Table 16: Used Hormonal Contraceptives in the Last Month", D_518916981, "104430631") 

#HORMONE
one_skip_funct(D_130311122, "Table 17: Used Prescription Hormone Therapy in the Last Month", D_518916981, "104430631") 


```

\newpage

# Mouthwash Data Collection 
```{r Mouthwash, warning=FALSE, echo=FALSE,  message=FALSE}


#ORALHLTH
BUM_tib$D_350251057 <- factor(BUM_tib$D_350251057,levels=c(670680466, 927477599, 719933364, 131550264, 138752522, 178420302, "Skipped this Question"))
simple_funct_BUM(D_350251057, "Table 117: Overall Health Ranking")



#MWBEFORE
simple_funct_BUM(D_877878167, "Table 19: Brushed Teeth Within the Hour Before Sample Donation")


#RINSEBEFORE
simple_funct_BUM(D_800703566, "Table 20: Rinsed Mouth Within the Hour Before Sample Donation")


#GUMBEFORE
simple_funct_BUM(D_294886836, "Table 21: Chewed Gum Within the Hour Before Sample Donation")


#TOBACCOBEFORE
simple_funct_BUM(D_642044281, "Table 22: Smoke, Vape or Chew Products Within the Hour Before Sample Donation")
```

\newpage
```{r Mouthwash_cont, warning=FALSE, echo=FALSE,  message=FALSE}

#HYGIENE
   
hy_prod <- BUM_tib %>%
  mutate(
    toothbrush = D_479143504_D_203919683 == 1,
    floss = D_479143504_D_807884576 == 1,
    water_flosser = D_479143504_D_165596977 == 1,
    tongue_cleaner = D_479143504_D_578402172 == 1,
    whitener = D_479143504_D_184513726 == 1,
    mouthwash = D_479143504_D_390351864 == 1,
    
    products = case_when(
      toothbrush & floss & water_flosser & tongue_cleaner & whitener & mouthwash ~ "All Products",
      floss & water_flosser & tongue_cleaner & whitener & mouthwash & !toothbrush ~ "All Products, Except Toothbrush",
      toothbrush & water_flosser & tongue_cleaner & whitener & mouthwash & !floss ~ "All Products, Except Floss",
      toothbrush & floss & tongue_cleaner & whitener & mouthwash & !water_flosser ~ "All Products, Except Water Based Flosser",
      toothbrush & floss & water_flosser & whitener & mouthwash & !tongue_cleaner ~ "All Products, Except Tongue Cleaner",
      toothbrush & floss & water_flosser & tongue_cleaner & mouthwash & !whitener ~ "All Products, Except Teeth Whitener",
      toothbrush & floss & water_flosser & tongue_cleaner & whitener & !mouthwash ~ "All Products, Except Mouthwash",
      
      toothbrush & floss & water_flosser & tongue_cleaner & !whitener & !mouthwash ~ "All Products, Except Teeth Whitener and Mouthwash",
      toothbrush & floss & water_flosser & whitener & !tongue_cleaner & !mouthwash ~ "All Products, Except Tongue Cleaner and Mouthwash",
      toothbrush & floss & water_flosser & tongue_cleaner & !whitener ~ "All Products, Except Tongue Cleaner and Teeth Whitener",
      toothbrush & water_flosser & tongue_cleaner & whitener & !floss & !mouthwash ~ "All Products, Except Floss and Mouthwash",
      toothbrush & water_flosser & tongue_cleaner & mouthwash & !floss & !whitener ~ "All Products, Except Floss and Teeth Whitener",
      toothbrush & whitener & tongue_cleaner & mouthwash & !floss & !water_flosser ~ "All Products, Except Floss and Water-based Flosser",
      
      toothbrush & floss & water_flosser ~ "Toothbrush, Floss, Water-based Flosser",
      toothbrush & floss & tongue_cleaner ~ "Toothbrush, Floss, Tongue Cleaner",
      toothbrush & floss & whitener ~ "Toothbrush, Floss, Teeth Whitener",
      toothbrush & floss & mouthwash ~ "Toothbrush, Floss, Mouthwash",
      toothbrush & water_flosser & tongue_cleaner ~ "Toothbrush, Water-based Flosser, Tongue Cleaner",
      toothbrush & water_flosser & whitener ~ "Toothbrush, Water-based Flosser, Teeth Whitener",
      toothbrush & water_flosser & mouthwash ~ "Toothbrush, Water-based Flosser, Mouthwash",
      toothbrush & tongue_cleaner & whitener ~ "Toothbrush, Tongue Cleaner, Teeth Whitener",
      toothbrush & tongue_cleaner & mouthwash ~ "Toothbrush, Tongue Cleaner, Mouthwash",
      toothbrush & whitener & mouthwash ~ "Toothbrush, Teeth Whitener, Mouthwash",
      
      toothbrush & floss ~ "Toothbrush, Floss",
      toothbrush & water_flosser ~ "Toothbrush, Water-based Flosser",
      toothbrush & tongue_cleaner ~ "Toothbrush, Tongue Cleaner",
      toothbrush & whitener ~ "Toothbrush, Teeth Whitener",
      toothbrush & mouthwash ~ "Toothbrush, Mouthwash",
      
      toothbrush ~ "Toothbrush",
      floss ~ "Floss",
      water_flosser ~ "Water-based flosser or jet",
      tongue_cleaner ~ "Tongue Cleaner",
      whitener ~ "Teeth Whitener",
      mouthwash ~ "Mouthwash",
      
      TRUE ~ "Skipped this Question"))

create_kable_table(hy_prod, products, "Table 122: Oral Health Products Used in the Last Month")




#BRUSH2
BUM_tib$D_498984275 <- factor(BUM_tib$D_498984275,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_498984275, "Table 123: Frequency Using a Toothbrush in the Last Month", D_479143504_D_203919683, "1")



#FLOSS2
BUM_tib$D_205713835 <- factor(BUM_tib$D_205713835,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_205713835, "Table 124: Frequency Using Floss in the Last Month", D_479143504_D_807884576, "1")


#WTRPICK2
BUM_tib$D_353467497 <- factor(BUM_tib$D_353467497,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_353467497, "Table 125: Frequency Using a Water Based Flosser or Pick in the Last Month", D_479143504_D_165596977, "1")



#TONGUE2
BUM_tib$D_429994023 <- factor(BUM_tib$D_429994023,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_429994023, "Table 126: Frequency Using a Tongue Scrubber in the Last Month", D_479143504_D_578402172, "1")



#WHITE2
BUM_tib$D_499977481 <- factor(BUM_tib$D_499977481,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_499977481, "Table 127: Frequency Using Teeth Whitener in the Last Month", D_479143504_D_184513726, "1")





#MWUSE

which_mwuse_flags <- BUM_tib %>%  filter(D_479143504_D_390351864==1) %>% 
  mutate(
    Alcohol_Based = as.numeric(D_406270109_D_950773275 == 1),
    Alcohol_Free = as.numeric(D_406270109_D_762727133 == 1),
    Chlorhexidine = as.numeric(D_406270109_D_877842367 == 1),
    Fluoride = as.numeric(D_406270109_D_886771318 == 1),
    Peroxide = as.numeric(D_406270109_D_404389800 == 1),
    Cetylpyridinium = as.numeric(D_406270109_D_463302301 == 1),
    Sensitive_Teeth = as.numeric(D_406270109_D_259744087 == 1),
    Dry_Mouth = as.numeric(D_406270109_D_523660949 == 1),
    Skipped = if_else(
      rowSums(select(., starts_with("D_406270109_D_")) == 0, na.rm = FALSE) == ncol(select(., starts_with("D_406270109_D_"))), 1, 0))


which_mwuse_long <- which_mwuse_flags %>%
  pivot_longer(
    cols = c(
      Alcohol_Based,
      Alcohol_Free,
      Chlorhexidine,
      Fluoride,
      Peroxide,
      Cetylpyridinium,
      Sensitive_Teeth,
      Dry_Mouth,
      Skipped
    ),
    names_to = "MW_Type",
    values_to = "Flag"
  ) %>%
  filter(Flag == 1) %>%
  mutate(
    product_type = case_when(
      MW_Type == "Alcohol_Based" ~ "Alcohol Based Mouthwash",
      MW_Type == "Alcohol_Free" ~ "Alcohol Free Mouthwash",
      MW_Type == "Chlorhexidine" ~ "Chlorhexidine Mouthwash",
      MW_Type == "Fluoride" ~ "Fluoride Mouthwash",
      MW_Type == "Peroxide" ~ "Peroxide Mouthwash",
      MW_Type == "Cetylpyridinium" ~ "Cetylpyridinium Chloride Mouthwash",
      MW_Type == "Sensitive_Teeth" ~ "Mouthwash for Sensitive Teeth",
      MW_Type == "Dry_Mouth" ~ "Mouthwash for Dry Mouth",
      MW_Type == "Skipped" ~ "Skipped this Question"
    )
  )


create_kable_table_w_footnote(which_mwuse_long, MW_Type, "Table 29: Mouthwash Products Used in the Last Month")




#MWALC
BUM_tib$D_349659426 <- factor(BUM_tib$D_349659426,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_349659426, "Table 129: Frequency Using Alcohol Based Mouthwash", D_406270109_D_950773275, "1")


#MWALCFREE
BUM_tib$D_766370065 <- factor(BUM_tib$D_766370065,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_766370065, "Table 130: Frequency Using Alcohol Free Mouthwash", D_406270109_D_762727133, "1")



#MWCHLOR
BUM_tib$D_520416570 <- factor(BUM_tib$D_520416570,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_520416570, "Table 131: Frequency Using Chlorhexidine Mouthwash", D_406270109_D_877842367, "1")


#MWFLOURIDE
BUM_tib$D_921972241 <- factor(BUM_tib$D_921972241,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_921972241, "Table 132: Frequency Using Flouride Mouthwash", D_406270109_D_886771318, "1")


#MWPEROX
BUM_tib$D_526973271 <- factor(BUM_tib$D_526973271,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_526973271, "Table 133: Frequency Using Peroxide Mouthwash", D_406270109_D_404389800, "1")


#MWCETYL
BUM_tib$D_460873842 <- factor(BUM_tib$D_460873842,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_460873842, "Table 134: Frequency Using Cetylpyridinium Cloride Mouthwash", D_406270109_D_463302301, "1")


#MWSENSITIVE
BUM_tib$D_430060900 <- factor(BUM_tib$D_430060900,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_430060900, "Table 135: Frequency Using Mouthwash for Sensitive Teeth", D_406270109_D_259744087, "1")


#MWDRY
BUM_tib$D_800752981 <- factor(BUM_tib$D_800752981,levels=c(648960871, 693256778, 735330419, 138332277, 858624942, 850675416 , "Skipped this Question"))
one_skip_funct(D_800752981,  "Table 136: Frequency Using Mouthwash for Dry Mouth", D_406270109_D_523660949, "1")








#PERMTTHLOST
  #Version1

 dt_PERMTTHLOST1= BUM_tib %>%   
  filter(d_822499427<as.Date("2022-11-29") & d_222161762<as.Date("2022-12-1")) %>%                                                    
   mutate(products= case_when((D_899251483_D_812107266==1 & D_899251483_D_452438775==1 & 
                                 D_899251483_V2_D_886864375==1) ~ "From Accident, Decay, and Other Reasons",
                              (D_899251483_D_812107266==1 & D_899251483_D_452438775==1) ~ "From Accident and Decay",
                              (D_899251483_D_812107266==1 & D_899251483_V2_D_886864375==1) ~ "From Accident and Other Reasons",
                              (D_899251483_D_452438775==1 & D_899251483_V2_D_886864375==1) ~ "From Decay and Other Reasons",
                              D_899251483_D_812107266==1 ~ "Yes from accident or injury",
                              D_899251483_D_452438775==1 ~ "Yes from tooth decay or disease",
                              D_899251483_V2_D_886864375==1 ~ "Yes for some other reason",
                              D_899251483_D_104430631==1 ~ "No",
                              TRUE   ~ "Skipped this Question"),
          products = factor(products,levels=c("From Accident, Decay, and Other Reasons", "From Accident and Decay", 
                                              "From Accident and Other Reasons", "From Decay and Other Reasons", 
                                              "Yes from accident or injury", "Yes from tooth decay or disease", 
                                              "Yes for some other reason", "No", "Skipped this Question")))

create_kable_table(dt_PERMTTHLOST1, products, "Table 38 (V1): Lost Permanent Adult Teeth, not Including your Wisdom Teeth")


  #Version2
dt_PERMTTHLOST2= BUM_tib %>%   
  filter(d_222161762>as.Date("2022-12-01")) %>% 
  mutate(products2= case_when((D_899251483_V2_D_812107266==1 & D_899251483_V2_D_452438775==1 & D_899251483_V2_D_886864375==1)~ "From Accident, Decay, and Other Reasons",
                                           (D_899251483_V2_D_812107266==1 & D_899251483_V2_D_452438775==1) ~ "From Accident and Decay",
                                           (D_899251483_V2_D_812107266==1 & D_899251483_V2_D_886864375==1) ~ "From Accident and Other Reasons",
                                           (D_899251483_V2_D_452438775==1 & D_899251483_V2_D_886864375==1) ~ "From Decay and Other Reasons",
                                           D_899251483_V2_D_812107266==1 ~ "Yes from accident or injury",
                                             D_899251483_V2_D_452438775==1 ~ "Yes from tooth decay or disease",
                                             D_899251483_V2_D_886864375==1 ~ "Yes for some other reason",
                                             D_899251483_V2_D_104430631==1 | D_899251483_V2_D_551489317==1  ~ "No",
                                             TRUE   ~ "Skipped this Question"),
         products2 = factor(products2,levels=c("From Accident, Decay, and Other Reasons", "From Accident and Decay", 
                                               "From Accident and Other Reasons", "From Decay and Other Reasons", "Yes from accident or injury",
                                               "Yes from tooth decay or disease", "Yes for some other reason", "No", "Skipped this Question")))

create_kable_table(dt_PERMTTHLOST2, products2, "Table 38 (V2): Lost Permanent Adult Teeth, not Including your Wisdom Teeth")
         


#TEETHLOSTAI
TEETHLOSTAI <- BUM_tib %>%  
  filter((D_899251483_V2_D_812107266==1 | D_899251483_D_812107266==1) & (d_822499427>as.Date("2022-12-1"))) %>%  
  mutate(answer= case_when(D_724589244==349122068 ~ "One", # | D_542661394_D_167336253==1
                           D_724589244==194129782~ "Two to Four",
                           D_724589244==922737557 ~ "Five to Nine",
                           D_724589244==945387130 ~ "10+",
                           D_724589244==383505459 ~ "More than 1 but Don't Remember",
                           D_724589244==832322940 ~ "Don't Know",
                           TRUE   ~ "Skipped this Question"),
         answer = factor(answer, levels= c("One", "Two to Four", "Five to Nine", "10+", "More than 1 but Don't Remember", "Don't Know", "Skipped this Question")))

create_kable_table(TEETHLOSTAI, answer, "Table 40: Number of Teeth Lost from Accident or Injury")




#TEETHLOSTD
TEETHLOSTD <- BUM_tib %>%   
  filter((D_899251483_V2_D_452438775==1 | D_899251483_D_452438775==1) & (d_822499427>as.Date("2022-12-1")))  %>%  
  mutate(answer= case_when(D_957305523==349122068 ~ "One", # | D_542661394_D_167336253==1
                           D_957305523==194129782~ "Two to Four",
                           D_957305523==922737557 ~ "Five to Nine",
                           D_957305523==945387130 ~ "10+",
                           D_957305523==383505459 ~ "More than 1 but Don't Remember",
                           D_957305523==832322940 ~ "Don't Know",
                           TRUE   ~ "Skipped this Question"),
         answer = factor(answer, levels= c("One", "Two to Four", "Five to Nine", "10+", 
                                           "More than 1 but Don't Remember", "Don't Know", "Skipped this Question")))
    
create_kable_table(TEETHLOSTD, answer, "Table 41: Number of Teeth Lost from Tooth Decay or Disease")
    



#TEETHLOSTOTH
TEETHLOSTOTH <- BUM_tib %>%   
  filter((D_899251483_V2_D_886864375==1) & (d_822499427>as.Date("2022-12-1"))) %>% 
  mutate(answer= case_when(D_360678252==349122068 ~ "One", # | D_542661394_D_167336253==1
                           D_360678252==194129782~ "Two to Four",
                           D_360678252==922737557 ~ "Five to Nine",
                           D_360678252==945387130 ~ "10+",
                           D_360678252==383505459 ~ "More than 1 but Don't Remember",
                           D_360678252==832322940 ~ "Don't Know",
                           TRUE   ~ "Skipped this Question"),
         answer = factor(answer, levels= c("One", "Two to Four", "Five to Nine", "10+", "More than 1 but Don't Remember", "Don't Know", "Skipped this Question")))
      
create_kable_table(TEETHLOSTOTH, answer, "Table 42: Number of Teeth Lost from Other Incidents")
      




#DENTURES
dnt= BUM_tib %>%  mutate(products= case_when(D_542661394_D_104430631==1 ~ "No", # | D_542661394_D_167336253==1
                                             D_542661394_D_329536041==1 ~ "Dental Bridges",
                                             D_542661394_D_365685000==1 ~ "Partial Denture",
                                             D_542661394_D_215662651==1 ~ "Full Dentures",
                                             D_542661394_D_656498939==1 ~ "Dental Implants",
                                             D_542661394_D_181769837==1 ~ "Other",
                                             D_542661394_D_178420302==1 ~ "Uknown",
                                             TRUE   ~ "Skipped this Question"),
                         products = factor(products, levels= c("No", "Dental Bridges", "Partial Denture", "Full Dentures", 
                                                               "Dental Implants", "Other", "Uknown", "Skipped this Question")))

create_kable_table(dnt, products, "Table 43: Lost Permanent Adult Teeth, not Including your Wisdom Teeth")



#DENTALCELAN
BUM_tib$D_339570897 <- factor(BUM_tib$D_339570897, levels= c(317567178, 891558680, 796081734, 752219885, 314487612, 178420302, "Skipped this Question"))
simple_funct_BUM(D_339570897, "Table 143: Last Professional Dental Cleaning")


#CAVITY
simple_funct_BUM(D_983043203, "Table 45: Had Cavities in Adult Teeth")


#GUMDISEASE
simple_funct_BUM(D_736028153, "Table 46: Diagnosed with Gum Disease")


#GUMTX
simple_funct_BUM(D_792134396, "Table 47: Treated for Gum Disease")


#ANTIBIO
simple_funct_BUM(D_736393021, "Table 48: Taken Antibiotics in the Last 2 Months")


#ANTIBIOTIME
BUM_tib$D_318641324 <- factor(BUM_tib$D_318641324, levels= c(666365344, 735136116, 382679079, 830677489, "Skipped this Question"))
one_skip_funct(D_318641324, "Table 148: Date Antiobiotic Last Taken", D_736393021, "353358909")



```




